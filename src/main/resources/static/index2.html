<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="stylesheet" href="leaflet-assets/leaflet.css" />
    <script src="leaflet-assets/leaflet.js"></script>
    <script src="testJsApp.js"></script>
    <title>Document</title>
  </head>
  <body>
    <label for="id-field">Enter bus id</label>
    <input type="text" id="id-field" />

    <button type="button" onclick="getBusLocation()">Get Location</button>

    <div id="map" style="height: 500px; width: 500px"></div>

    <script>
      function getBusLocation() {
        var busId = document.getElementById("id-field").value;

        fetch("find-bus", {
          method: "get",
          headers: { "Conent-type": "application/json" },
          body: JSON.stringify({ id: busId }),
        })
          .then((response) => {
            if (!response.ok) {
              throw new Error("HTTP-Error: " + response.status);
            }

            return response.json();
          })
          .then((data) => {
            var latitude = data.latitude;
            var longitude = data.longitude;

            var map = L.map("map").setView(
              [latitude, longitude],
              14
            );

            L.tileLayer("https://tile.openstreetmap.org/{z}/{x}/{y}.png", {
              maxZoom: 19,
              attribution:
                '&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',
            }).addTo(map);

            var marker = L.marker([latitude, longitude]).addTo(map);
          })
          .catch((error) => {
            console.error("error");
          });
      }
    </script>
  </body>
</html>
